<%# provide(:title, @project.project_name) %>
<div class="row">
	<div class="span8 offset2">
		<%= render 'header' %>
  
    <h3>Project Summary</h3>
    
    <% @project.observations.each do |obs| %>
      <div class="alert alert-warning">
        <p><h4><%= Entity.find(obs.entity_id).entity_name %></h4></p>

        <%#= obs.id %>

        <% @contexts = @project.contexts.where(["observation_id = ?", obs.id]) %>
        <% @contexts.each do |con| %>
          <p>Has context: <%= Entity.find(Observation.find(con.has_context_id).entity_id).entity_name %></p>
        <% end %>

        <% obs.measurements.each do |mea| %>
          <div class="alert alert-danger">
            <% if !mea.trait_id.blank? %>
              Has measured trait: <%= Trait.find(mea.trait_id).trait_name %>
              <% if !mea.standard_id.blank? %>
              , using standard: <%= Standard.find(mea.standard_id).standard_name %>
              <% else %>
              , using no standard.</p>
              <% end %>
            <% end %>
          </div>
        <% end %>
      </div>
    <% end %>
    
    
    <h3>Data</h3>
    
    <table class="table">
      <tr>
        <% @project.observations.each do |obs| %>
          <% obs.measurements.each do |mea| %>
            <th>
              <%= Trait.find(Measurement.find(mea.id).trait_id).trait_name %> 
            </th>
          <% end %>
        <% end %>
      </tr>

      <% @project.rows.each do |row| %>
        <tr>
          <% row.points.each do |poi| %>
            <td><%= poi.value %></td>
          <% end %>
        </tr>
      <% end %>  
    </table>
      
    
  </div>
</div>
<br/>
